================================================================================
NGINX PROXY MANAGER - QUICK SETUP FOR auth.korczewski.de
================================================================================

ğŸ“‹ COPY-PASTE VALUES FOR NPM

1. ADD PROXY HOST
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

   DETAILS TAB:
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Domain Names:           auth.korczewski.de
   Scheme:                 http
   Forward Hostname/IP:    <YOUR_SERVER_IP_OR_HOSTNAME>
                          â†‘ Use "localhost" if on same machine
                          â†‘ Use "192.168.x.x" if on different machine
   Forward Port:           5500

   Options:
   â˜‘ Cache Assets
   â˜‘ Block Common Exploits
   â˜‘ Websockets Support
   â˜ Access List (None)

   SSL TAB:
   â”€â”€â”€â”€â”€â”€â”€â”€
   SSL Certificate:        Request a new SSL Certificate
                          (or use existing *.korczewski.de if you have it)

   â˜‘ Force SSL
   â˜‘ HTTP/2 Support
   â˜‘ HSTS Enabled
   â˜ HSTS Subdomains

   Email:                  <your-email@example.com>
   â˜‘ I Agree to the Let's Encrypt Terms of Service

   ADVANCED TAB (Optional - Copy-Paste):
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
client_max_body_size 10M;

proxy_set_header Host $host;
proxy_set_header X-Real-IP $remote_addr;
proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
proxy_set_header X-Forwarded-Proto $scheme;
proxy_set_header X-Forwarded-Host $host;
proxy_set_header X-Forwarded-Port $server_port;

add_header Access-Control-Allow-Origin $http_origin always;
add_header Access-Control-Allow-Credentials true always;
add_header Access-Control-Allow-Methods "GET, POST, PUT, PATCH, DELETE, OPTIONS" always;
add_header Access-Control-Allow-Headers "Authorization, Content-Type, Accept, Origin, X-Requested-With" always;

if ($request_method = OPTIONS) {
    return 204;
}

add_header X-Frame-Options "SAMEORIGIN" always;
add_header X-Content-Type-Options "nosniff" always;
add_header X-XSS-Protection "1; mode=block" always;
add_header Referrer-Policy "strict-origin-when-cross-origin" always;

2. SAVE AND WAIT
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Click "Save" and wait 1-2 minutes for SSL certificate to be issued.

3. TEST
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   curl https://auth.korczewski.de/health

   Should return: {"status":"healthy",...}

================================================================================
GOOGLE OAUTH CONFIGURATION
================================================================================

You MUST update your Google OAuth settings:

1. Go to: https://console.cloud.google.com/apis/credentials
2. Select your OAuth 2.0 Client ID
3. Under "Authorized redirect URIs", ADD:

   https://auth.korczewski.de/api/oauth/google/callback

4. Save

================================================================================
AUTH SERVICE .ENV UPDATE
================================================================================

Update these values in /home/patrick/projects/auth/.env:

NODE_ENV=production
GOOGLE_REDIRECT_URI=https://auth.korczewski.de/api/oauth/google/callback
ALLOWED_ORIGINS=https://l2p.korczewski.de,https://videovault.korczewski.de,https://payment.korczewski.de
CORS_ORIGIN=https://auth.korczewski.de,https://l2p.korczewski.de,https://videovault.korczewski.de,https://payment.korczewski.de

Then restart: npm run build && npm start

================================================================================
VERIFICATION STEPS
================================================================================

After NPM setup, test these URLs in your browser:

âœ… https://auth.korczewski.de/health          (API health check)
âœ… https://auth.korczewski.de/login           (Login page)
âœ… https://auth.korczewski.de/api/oauth/google (OAuth redirect - should go to Google)

================================================================================
TROUBLESHOOTING
================================================================================

502 Bad Gateway?
â†’ Check auth service is running: curl http://localhost:5500/health
â†’ Check Forward Hostname/IP is correct in NPM

SSL Certificate Failed?
â†’ Check DNS: nslookup auth.korczewski.de
â†’ Wait 5 minutes and try again

CORS Errors?
â†’ Make sure Advanced config is added (see above)
â†’ Check CORS_ORIGIN in .env includes your domains

OAuth Not Working?
â†’ Verify Google OAuth Console has the https:// redirect URI
â†’ Check .env has GOOGLE_REDIRECT_URI set correctly

================================================================================
